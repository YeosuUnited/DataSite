<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>선수 기록 보기</title>
    <style>
        table {
            margin: auto;
            border-collapse: collapse;
            width: 80%; /* 적정 크기로 설정 */
            max-width: 1000px; /* 최대 크기 고정 */
            border: 1px solid lightgray;
            table-layout: fixed; /* 고정된 레이아웃 */
            overflow-x: auto;
            white-space: nowrap; /* 행의 내용을 한 줄로 고정 */
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: white; /* 이름 행 배경을 흰색으로 고정 */
            position: sticky;
            top: 0;
            z-index: 1;
        }
        td {
            background-color: #f7f7f7; /* 나머지 행은 기본 회색 */
        }
        tr:hover td {
            background-color: white; /* 선택된 행은 흰색 배경 */
        }
        .highlight {
            border: 2px solid red;
        }
        .table-container {
            width: 80%; /* 테이블을 감싸는 컨테이너의 크기 */
            max-width: 1000px;
            overflow-x: auto; /* 좌우 스크롤 가능하게 설정 */
            margin: auto;
        }
    </style>
    <script>
        let currentSortColumn = '득점';
        let currentSortDirection = 'desc';

        function sortTable(data, column, direction) {
            return data.sort((a, b) => {
                let valA = a[column];
                let valB = b[column];
                
                if (!isNaN(valA) && !isNaN(valB)) {
                    valA = Number(valA);
                    valB = Number(valB);
                }

                if (valA > valB) {
                    return direction === 'desc' ? -1 : 1;
                }
                if (valA < valB) {
                    return direction === 'desc' ? 1 : -1;
                }
                return 0;
            });
        }

        function displayPlayerRecord() {
            const cachedData = JSON.parse(localStorage.getItem('cachedData'));
            const data = cachedData?.playerRecord;

            if (data) {
                let sortedData = sortTable(data, currentSortColumn, currentSortDirection);

                 let html = '<table><tr>' +
                    `<th class="${currentSortColumn === '이름' ? 'highlight' : ''}" onclick="sortBy('이름')">이름</th>` +
                    `<th class="${currentSortColumn === '득점' ? 'highlight' : ''}" onclick="sortBy('득점')">득점</th>` +
                    `<th class="${currentSortColumn === '도움' ? 'highlight' : ''}" onclick="sortBy('도움')">도움</th>` +
                    `<th class="${currentSortColumn === '공격포인트' ? 'highlight' : ''}" onclick="sortBy('공격포인트')">공격포인트</th>` +
                    `<th class="${currentSortColumn === '경기수' ? 'highlight' : ''}" onclick="sortBy('경기수')">경기수</th>` +
                    `<th class="${currentSortColumn === 'MOM' ? 'highlight' : ''}" onclick="sortBy('MOM')">MOM</th>` +
                    `<th class="${currentSortColumn === '승' ? 'highlight' : ''}" onclick="sortBy('승')">승</th>` +
                    `<th class="${currentSortColumn === '패' ? 'highlight' : ''}" onclick="sortBy('패')">패</th>` +
                    '</tr>';
                
                sortedData.forEach(player => {
                    html += `<tr>
                                <td>${player.이름}</td>
                                <td>${player.득점}</td>
                                <td>${player.도움}</td>
                                <td>${player.공격포인트}</td>
                                <td>${player.경기수}</td>
                                <td>${player.MOM}</td>
                                <td>${player.승}</td>
                                <td>${player.패}</td>
                             </tr>`;
                });
                html += '</table>';

                document.getElementById('playerData').innerHTML = html;
            } else {
                document.getElementById('playerData').innerText = '캐시된 데이터를 찾을 수 없습니다.';
            }
        }

        function sortBy(column) {
            const cachedData = JSON.parse(localStorage.getItem('cachedData'));
            const data = cachedData?.playerRecord;

            if (data) {
                if (currentSortColumn === column) {
                    currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSortDirection = 'desc';
                    currentSortColumn = column;
                }

                let sortedData = sortTable(data, column, currentSortDirection);
                let html = '<table><tr>' +
                    `<th class="${currentSortColumn === '이름' ? 'highlight' : ''}" onclick="sortBy('이름')">이름</th>` +
                    `<th class="${currentSortColumn === '득점' ? 'highlight' : ''}" onclick="sortBy('득점')">득점</th>` +
                    `<th class="${currentSortColumn === '도움' ? 'highlight' : ''}" onclick="sortBy('도움')">도움</th>` +
                    `<th class="${currentSortColumn === '공격포인트' ? 'highlight' : ''}" onclick="sortBy('공격포인트')">공격포인트</th>` +
                    `<th class="${currentSortColumn === '경기수' ? 'highlight' : ''}" onclick="sortBy('경기수')">경기수</th>` +
                    `<th class="${currentSortColumn === 'MOM' ? 'highlight' : ''}" onclick="sortBy('MOM')">MOM</th>` +
                    `<th class="${currentSortColumn === '승' ? 'highlight' : ''}" onclick="sortBy('승')">승</th>` +
                    `<th class="${currentSortColumn === '패' ? 'highlight' : ''}" onclick="sortBy('패')">패</th>` +
                    '</tr>';
                
                sortedData.forEach(player => {
                    html += `<tr>
                                <td>${player.이름}</td>
                                <td>${player.득점}</td>
                                <td>${player.도움}</td>
                                <td>${player.공격포인트}</td>
                                <td>${player.경기수}</td>
                                <td>${player.MOM}</td>
                                <td>${player.승}</td>
                                <td>${player.패}</td>
                             </tr>`;
                });
                html += '</table>';

                document.getElementById('playerData').innerHTML = html;
            }
        }

        window.onload = displayPlayerRecord;
    </script>
</head>
<body>
    <h1>선수 기록</h1>
    <div class="table-container">
        <div id="playerData">캐싱데이터 불러오는 중...</div>
    </div>
</body>
</html>
